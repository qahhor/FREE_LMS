{
  "annotations": { "list": [] },
  "description": "Smartup LMS - JVM Performance Metrics for Spring Boot Services",
  "editable": true,
  "gnetId": null,
  "graphTooltip": 1,
  "id": null,
  "links": [],
  "panels": [
    {
      "collapsed": false,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 0 },
      "id": 100,
      "panels": [],
      "title": "Memory",
      "type": "row"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "axisLabel": "", "axisPlacement": "auto", "drawStyle": "line", "fillOpacity": 20, "lineInterpolation": "smooth", "lineWidth": 2, "showPoints": "never", "spanNulls": false },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "bytes"
        }
      },
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 1 },
      "id": 1,
      "options": { "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom" }, "tooltip": { "mode": "multi" } },
      "targets": [
        { "expr": "jvm_memory_used_bytes{area=\"heap\", service=\"$service\"}", "legendFormat": "Used Heap", "refId": "A" },
        { "expr": "jvm_memory_committed_bytes{area=\"heap\", service=\"$service\"}", "legendFormat": "Committed Heap", "refId": "B" },
        { "expr": "jvm_memory_max_bytes{area=\"heap\", service=\"$service\"}", "legendFormat": "Max Heap", "refId": "C" }
      ],
      "title": "Heap Memory - $service",
      "type": "timeseries"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "axisLabel": "", "axisPlacement": "auto", "drawStyle": "line", "fillOpacity": 20, "lineInterpolation": "smooth", "lineWidth": 2, "showPoints": "never", "spanNulls": false },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "bytes"
        }
      },
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 1 },
      "id": 2,
      "options": { "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom" }, "tooltip": { "mode": "multi" } },
      "targets": [
        { "expr": "jvm_memory_used_bytes{area=\"nonheap\", service=\"$service\"}", "legendFormat": "Used Non-Heap", "refId": "A" },
        { "expr": "jvm_memory_committed_bytes{area=\"nonheap\", service=\"$service\"}", "legendFormat": "Committed Non-Heap", "refId": "B" }
      ],
      "title": "Non-Heap Memory - $service",
      "type": "timeseries"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "axisLabel": "", "axisPlacement": "auto", "drawStyle": "line", "fillOpacity": 20, "lineInterpolation": "smooth", "lineWidth": 2, "showPoints": "never", "spanNulls": false },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "bytes"
        }
      },
      "gridPos": { "h": 8, "w": 24, "x": 0, "y": 9 },
      "id": 3,
      "options": { "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "right" }, "tooltip": { "mode": "multi" } },
      "targets": [
        { "expr": "jvm_memory_used_bytes{id=~\".*Eden.*\", service=\"$service\"}", "legendFormat": "Eden Space", "refId": "A" },
        { "expr": "jvm_memory_used_bytes{id=~\".*Survivor.*\", service=\"$service\"}", "legendFormat": "Survivor Space", "refId": "B" },
        { "expr": "jvm_memory_used_bytes{id=~\".*Old.*|.*Tenured.*\", service=\"$service\"}", "legendFormat": "Old Gen", "refId": "C" },
        { "expr": "jvm_memory_used_bytes{id=~\".*Metaspace.*\", service=\"$service\"}", "legendFormat": "Metaspace", "refId": "D" }
      ],
      "title": "Memory Pools - $service",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 17 },
      "id": 101,
      "panels": [],
      "title": "Garbage Collection",
      "type": "row"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "axisLabel": "", "axisPlacement": "auto", "drawStyle": "line", "fillOpacity": 20, "lineInterpolation": "smooth", "lineWidth": 2, "showPoints": "never", "spanNulls": false },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "s"
        }
      },
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 18 },
      "id": 10,
      "options": { "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom" }, "tooltip": { "mode": "multi" } },
      "targets": [
        { "expr": "rate(jvm_gc_pause_seconds_sum{service=\"$service\"}[5m])", "legendFormat": "{{ action }} - {{ cause }}", "refId": "A" }
      ],
      "title": "GC Pause Time Rate - $service",
      "type": "timeseries"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "axisLabel": "", "axisPlacement": "auto", "drawStyle": "line", "fillOpacity": 20, "lineInterpolation": "smooth", "lineWidth": 2, "showPoints": "never", "spanNulls": false },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "short"
        }
      },
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 18 },
      "id": 11,
      "options": { "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom" }, "tooltip": { "mode": "multi" } },
      "targets": [
        { "expr": "rate(jvm_gc_pause_seconds_count{service=\"$service\"}[5m])", "legendFormat": "{{ action }} - {{ cause }}", "refId": "A" }
      ],
      "title": "GC Pause Count Rate - $service",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 26 },
      "id": 102,
      "panels": [],
      "title": "Threads",
      "type": "row"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "axisLabel": "", "axisPlacement": "auto", "drawStyle": "line", "fillOpacity": 20, "lineInterpolation": "smooth", "lineWidth": 2, "showPoints": "never", "spanNulls": false },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "short"
        }
      },
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 27 },
      "id": 20,
      "options": { "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom" }, "tooltip": { "mode": "multi" } },
      "targets": [
        { "expr": "jvm_threads_live_threads{service=\"$service\"}", "legendFormat": "Live Threads", "refId": "A" },
        { "expr": "jvm_threads_daemon_threads{service=\"$service\"}", "legendFormat": "Daemon Threads", "refId": "B" },
        { "expr": "jvm_threads_peak_threads{service=\"$service\"}", "legendFormat": "Peak Threads", "refId": "C" }
      ],
      "title": "Thread Count - $service",
      "type": "timeseries"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "axisLabel": "", "axisPlacement": "auto", "drawStyle": "line", "fillOpacity": 20, "lineInterpolation": "smooth", "lineWidth": 2, "showPoints": "never", "spanNulls": false },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "short"
        }
      },
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 27 },
      "id": 21,
      "options": { "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom" }, "tooltip": { "mode": "multi" } },
      "targets": [
        { "expr": "jvm_threads_states_threads{service=\"$service\"}", "legendFormat": "{{ state }}", "refId": "A" }
      ],
      "title": "Thread States - $service",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 35 },
      "id": 103,
      "panels": [],
      "title": "CPU & Classes",
      "type": "row"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "axisLabel": "", "axisPlacement": "auto", "drawStyle": "line", "fillOpacity": 20, "lineInterpolation": "smooth", "lineWidth": 2, "showPoints": "never", "spanNulls": false },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 0.7 }, { "color": "red", "value": 0.9 }] },
          "unit": "percentunit"
        }
      },
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 36 },
      "id": 30,
      "options": { "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom" }, "tooltip": { "mode": "multi" } },
      "targets": [
        { "expr": "process_cpu_usage{service=\"$service\"}", "legendFormat": "Process CPU", "refId": "A" },
        { "expr": "system_cpu_usage{service=\"$service\"}", "legendFormat": "System CPU", "refId": "B" }
      ],
      "title": "CPU Usage - $service",
      "type": "timeseries"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "axisLabel": "", "axisPlacement": "auto", "drawStyle": "line", "fillOpacity": 20, "lineInterpolation": "smooth", "lineWidth": 2, "showPoints": "never", "spanNulls": false },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "short"
        }
      },
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 36 },
      "id": 31,
      "options": { "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom" }, "tooltip": { "mode": "multi" } },
      "targets": [
        { "expr": "jvm_classes_loaded_classes{service=\"$service\"}", "legendFormat": "Loaded Classes", "refId": "A" },
        { "expr": "jvm_classes_unloaded_classes_total{service=\"$service\"}", "legendFormat": "Unloaded Classes", "refId": "B" }
      ],
      "title": "Class Loading - $service",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 44 },
      "id": 104,
      "panels": [],
      "title": "HikariCP Connection Pool",
      "type": "row"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "axisLabel": "", "axisPlacement": "auto", "drawStyle": "line", "fillOpacity": 20, "lineInterpolation": "smooth", "lineWidth": 2, "showPoints": "never", "spanNulls": false },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "short"
        }
      },
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 45 },
      "id": 40,
      "options": { "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom" }, "tooltip": { "mode": "multi" } },
      "targets": [
        { "expr": "hikaricp_connections_active{service=\"$service\"}", "legendFormat": "Active", "refId": "A" },
        { "expr": "hikaricp_connections_idle{service=\"$service\"}", "legendFormat": "Idle", "refId": "B" },
        { "expr": "hikaricp_connections_pending{service=\"$service\"}", "legendFormat": "Pending", "refId": "C" },
        { "expr": "hikaricp_connections_max{service=\"$service\"}", "legendFormat": "Max", "refId": "D" }
      ],
      "title": "HikariCP Connections - $service",
      "type": "timeseries"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "axisLabel": "", "axisPlacement": "auto", "drawStyle": "line", "fillOpacity": 20, "lineInterpolation": "smooth", "lineWidth": 2, "showPoints": "never", "spanNulls": false },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "s"
        }
      },
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 45 },
      "id": 41,
      "options": { "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom" }, "tooltip": { "mode": "multi" } },
      "targets": [
        { "expr": "hikaricp_connections_acquire_seconds_sum{service=\"$service\"} / hikaricp_connections_acquire_seconds_count{service=\"$service\"}", "legendFormat": "Avg Acquire Time", "refId": "A" },
        { "expr": "hikaricp_connections_usage_seconds_sum{service=\"$service\"} / hikaricp_connections_usage_seconds_count{service=\"$service\"}", "legendFormat": "Avg Usage Time", "refId": "B" }
      ],
      "title": "HikariCP Timing - $service",
      "type": "timeseries"
    }
  ],
  "refresh": "30s",
  "schemaVersion": 30,
  "style": "dark",
  "tags": ["freelms", "jvm", "spring-boot"],
  "templating": {
    "list": [
      {
        "allValue": null,
        "current": { "selected": true, "text": "auth-service", "value": "auth-service" },
        "datasource": "Prometheus",
        "definition": "label_values(up, service)",
        "description": null,
        "error": null,
        "hide": 0,
        "includeAll": false,
        "label": "Service",
        "multi": false,
        "name": "service",
        "options": [],
        "query": { "query": "label_values(up, service)", "refId": "StandardVariableQuery" },
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "sort": 1,
        "type": "query"
      }
    ]
  },
  "time": { "from": "now-1h", "to": "now" },
  "timepicker": {},
  "timezone": "browser",
  "title": "Smartup LMS - JVM Performance",
  "uid": "freelms-jvm",
  "version": 1
}
