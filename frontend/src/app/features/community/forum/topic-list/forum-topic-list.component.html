<div class="forum-topic-list-container">
  <!-- Breadcrumb -->
  <nav class="breadcrumb">
    <a routerLink="/forum">Forum</a>
    <span class="separator">‚Ä∫</span>
    <span *ngIf="category">{{ category.name }}</span>
  </nav>

  <!-- Category Header -->
  <div *ngIf="category" class="category-header">
    <div class="category-icon" [style.background-color]="category.color || '#667eea'">
      <span *ngIf="category.icon">{{ category.icon }}</span>
      <span *ngIf="!category.icon">üí¨</span>
    </div>
    <div class="category-info">
      <h1>{{ category.name }}</h1>
      <p>{{ category.description }}</p>
      <div class="category-stats">
        <span>{{ formatNumber(category.topicsCount) }} topics</span>
        <span class="dot">‚Ä¢</span>
        <span>{{ formatNumber(category.postsCount) }} posts</span>
      </div>
    </div>
    <button class="btn btn-primary" routerLink="/forum/create" [queryParams]="{category: category.id}">
      <i class="icon-plus"></i> New Topic
    </button>
  </div>

  <!-- Search Bar -->
  <div class="search-bar">
    <input
      type="text"
      [(ngModel)]="searchQuery"
      (keyup.enter)="onSearch()"
      placeholder="Search topics..."
      class="search-input"
    />
    <button class="btn btn-primary" (click)="onSearch()">Search</button>
  </div>

  <!-- Popular Tags -->
  <div *ngIf="popularTags.length > 0" class="popular-tags">
    <h3>Popular Tags</h3>
    <div class="tags-list">
      <span
        *ngFor="let tag of popularTags"
        class="tag"
        [style.background-color]="tag.color || '#e5e7eb'"
      >
        #{{ tag.name }}
        <span class="tag-count">{{ tag.usageCount }}</span>
      </span>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-state">
    <div class="spinner"></div>
    <p>Loading topics...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error" class="error-state">
    <div class="error-icon">‚ö†Ô∏è</div>
    <p>{{ error }}</p>
    <button class="btn btn-secondary" (click)="loadTopics(category!.slug)">
      Try Again
    </button>
  </div>

  <!-- Topics List -->
  <div *ngIf="!loading && !error" class="topics-list">
    <div *ngFor="let topic of topics" class="topic-card" [class.pinned]="topic.isPinned">
      <a [routerLink]="['/forum/topic', topic.slug]" class="topic-link">
        <!-- Topic Status Icons -->
        <div class="topic-status">
          <span *ngIf="topic.isPinned" class="status-badge pinned" title="Pinned">üìå</span>
          <span *ngIf="topic.isLocked" class="status-badge locked" title="Locked">üîí</span>
        </div>

        <!-- Topic Content -->
        <div class="topic-content">
          <h3 class="topic-title">{{ topic.title }}</h3>

          <!-- Tags -->
          <div *ngIf="topic.tags && topic.tags.length > 0" class="topic-tags">
            <span *ngFor="let tag of topic.tags" class="tag-small">
              #{{ tag.name }}
            </span>
          </div>

          <!-- Author & Date -->
          <div class="topic-meta">
            <span class="author">
              {{ topic.author.firstName }} {{ topic.author.lastName }}
            </span>
            <span class="dot">‚Ä¢</span>
            <span class="date">{{ formatDate(topic.createdAt) }}</span>
          </div>
        </div>

        <!-- Topic Stats -->
        <div class="topic-stats">
          <div class="stat">
            <i class="icon-eye"></i>
            <span>{{ formatNumber(topic.viewsCount) }}</span>
          </div>
          <div class="stat">
            <i class="icon-message"></i>
            <span>{{ formatNumber(topic.repliesCount) }}</span>
          </div>
          <div class="stat">
            <i class="icon-heart"></i>
            <span>{{ formatNumber(topic.likesCount) }}</span>
          </div>
        </div>

        <!-- Last Activity -->
        <div *ngIf="topic.lastPostAt && topic.lastPostAuthor" class="last-activity">
          <div class="activity-text">Last reply by</div>
          <div class="activity-author">
            {{ topic.lastPostAuthor.firstName }} {{ topic.lastPostAuthor.lastName }}
          </div>
          <div class="activity-date">{{ formatDate(topic.lastPostAt) }}</div>
        </div>
      </a>
    </div>
  </div>

  <!-- Empty State -->
  <div *ngIf="!loading && !error && topics.length === 0" class="empty-state">
    <div class="empty-icon">üìù</div>
    <h3>No Topics Yet</h3>
    <p *ngIf="searchQuery">No topics found matching your search.</p>
    <p *ngIf="!searchQuery">Be the first to start a discussion in this category!</p>
    <button class="btn btn-primary" routerLink="/forum/create" [queryParams]="{category: category?.id}">
      Create First Topic
    </button>
  </div>

  <!-- Pagination -->
  <div *ngIf="!loading && !error && totalPages > 1" class="pagination">
    <button
      class="pagination-btn"
      [disabled]="currentPage === 1"
      (click)="onPageChange(currentPage - 1)"
    >
      ‚Äπ Previous
    </button>

    <button
      *ngFor="let page of getPageNumbers()"
      class="pagination-btn page-number"
      [class.active]="page === currentPage"
      (click)="onPageChange(page)"
    >
      {{ page }}
    </button>

    <button
      class="pagination-btn"
      [disabled]="currentPage === totalPages"
      (click)="onPageChange(currentPage + 1)"
    >
      Next ‚Ä∫
    </button>
  </div>
</div>
